!function(e){"use strict";e.fn.maximage=function(i,t){function a(e){window.console&&window.console.log&&window.console.log(e)}var d;"object"!=typeof i&&void 0!==i||(d=e.extend(e.fn.maximage.defaults,i||{})),"string"==typeof i&&(d=e.fn.maximage.defaults),e.Body=e("body"),e.Window=e(window),e.Scroll=e("html, body"),e.Events={RESIZE:"resize"},this.each(function(){var t=e(this),n=0,s=[],o={setup:function(){if(e.Slides.length>0){for(var i in e.Slides){var a=e.Slides[i];t.append('<div class="mc-image '+a.theclass+'" title="'+a.alt+'" style="background-image:url(\''+a.url+"');"+a.style+'" data-href="'+a.datahref+'">'+a.content+"</div>")}o.preload(0),o.resize()}},preload:function(i){var a=e("<img/>");a.load(function(){0==n&&(c.setup(),d.onFirstImageLoaded()),n==e.Slides.length-1?d.onImagesLoaded(t):(n++,o.preload(n))}),a[0].src=e.Slides[i].url,s.push(a[0])},resize:function(){e.Window.bind(e.Events.RESIZE,function(){e.Scroll.addClass("mc-hide-scrolls"),e.Window.data("h",h.sizes().h).data("w",h.sizes().w),t.height(e.Window.data("h")).width(e.Window.data("w")).children().height(e.Window.data("h")).width(e.Window.data("w")),t.children().each(function(){this.cycleH=e.Window.data("h"),this.cycleW=e.Window.data("w")}),e(e.Scroll).removeClass("mc-hide-scrolls")})}},r={setup:function(){var i,a;if(e.BrowserTests.msie&&!d.overrideMSIEStop&&document.execCommand("Stop",!1),t.html(""),e.Body.addClass("mc-old-browser"),e.Slides.length>0){e.Scroll.addClass("mc-hide-scrolls"),e.Window.data("h",h.sizes().h).data("w",h.sizes().w),e("body").append(e("<div></div>").attr("class","mc-loader").css({position:"absolute",left:"-9999px"}));for(var n in e.Slides)i=0==e.Slides[n].content.length?'<img src="'+e.Slides[n].url+'" />':e.Slides[n].content,a=e("<div>"+i+"</div>").attr("class","mc-image mc-image-n"+n+" "+e.Slides[n].theclass),t.append(a),0==e(".mc-image-n"+n).children("img").length||e("div.mc-loader").append(e(".mc-image-n"+n).children("img").first().clone().addClass("not-loaded"));r.preload(),r.windowResize()}},preload:function(){var i=setInterval(function(){e(".mc-loader").children("img").each(function(i){var t=e(this);t.hasClass("not-loaded")&&t.height()>0&&(e(this).removeClass("not-loaded"),e("div.mc-image-n"+i).children("img").first().data("h",t.height()).data("w",t.width()).data("ar",t.width()/t.height()),r.onceLoaded(i))}),0==e(".not-loaded").length&&(e(".mc-loader").remove(),clearInterval(i))},1e3)},onceLoaded:function(i){r.maximage(i),0==i?(t.css({visibility:"visible"}),d.onFirstImageLoaded()):i==e.Slides.length-1&&(c.setup(),e(e.Scroll).removeClass("mc-hide-scrolls"),d.onImagesLoaded(t),d.debug&&(a(" - Final Maximage - "),a(t)))},maximage:function(i){e("div.mc-image-n"+i).height(e.Window.data("h")).width(e.Window.data("w")).children("img").first().each(function(){l.maxcover(e(this))})},windowResize:function(){e.Window.bind(e.Events.RESIZE,function(){clearTimeout(this.id),this.id=setTimeout(r.doneResizing,200)})},doneResizing:function(){e(e.Scroll).addClass("mc-hide-scrolls"),e.Window.data("h",h.sizes().h).data("w",h.sizes().w),t.height(e.Window.data("h")).width(e.Window.data("w")),t.find(".mc-image").each(function(e){r.maximage(e)});var i=t.data("cycle.opts");void 0!=i&&(i.height=e.Window.data("h"),i.width=e.Window.data("w"),jQuery.each(i.elements,function(i,t){t.cycleW=e.Window.data("w"),t.cycleH=e.Window.data("h")})),e(e.Scroll).removeClass("mc-hide-scrolls")}},c={setup:function(){t.addClass("mc-cycle"),e.Window.data("h",h.sizes().h).data("w",h.sizes().w),jQuery.easing.easeForCSSTransition=function(e,i,t,a,d,n){return t+a};var i=e.extend({fit:1,containerResize:0,height:e.Window.data("h"),width:e.Window.data("w"),slideResize:!1,easing:e.BrowserTests.cssTransitions&&d.cssTransitions?"easeForCSSTransition":"swing"},d.cycleOptions);t.cycle(i)}},l={center:function(i){d.verticalCenter&&i.css({marginTop:(i.height()-e.Window.data("h"))/2*-1}),d.horizontalCenter&&i.css({marginLeft:(i.width()-e.Window.data("w"))/2*-1})},fill:function(i){var t=i.is("object")?i.parent().first():i;"function"==typeof d.backgroundSize?d.backgroundSize(i):"cover"==d.backgroundSize?e.Window.data("w")/e.Window.data("h")<t.data("ar")?i.height(e.Window.data("h")).width((e.Window.data("h")*t.data("ar")).toFixed(0)):i.height((e.Window.data("w")/t.data("ar")).toFixed(0)).width(e.Window.data("w")):"contain"==d.backgroundSize?e.Window.data("w")/e.Window.data("h")<t.data("ar")?i.height((e.Window.data("w")/t.data("ar")).toFixed(0)).width(e.Window.data("w")):i.height(e.Window.data("h")).width((e.Window.data("h")*t.data("ar")).toFixed(0)):a("The backgroundSize option was not recognized for older browsers.")},maxcover:function(e){l.fill(e),l.center(e)},maxcontain:function(e){l.fill(e),l.center(e)}},h={browser_tests:function(){var i=e("<div />")[0],t=["Moz","Webkit","Khtml","O","ms"],n="transition",s={cssTransitions:!1,cssBackgroundSize:"backgroundSize"in i.style&&d.cssBackgroundSize,html5Video:!1,msie:!1};if(d.cssTransitions){"string"==typeof i.style[n]&&(s.cssTransitions=!0),n=n.charAt(0).toUpperCase()+n.substr(1);for(var o=0;o<t.length;o++)t[o]+n in i.style&&(s.cssTransitions=!0)}return document.createElement("video").canPlayType&&(s.html5Video=!0),s.msie=void 0!==h.msie(),d.debug&&(a(" - Browser Test - "),a(s)),s},construct_slide_object:function(){var i=new Object,n=new Array;return t.children().each(function(t){var a=e(this).is("img")?e(this).clone():e(this).find("img").first().clone();(i={}).url=a.attr("src"),i.title=void 0!=a.attr("title")?a.attr("title"):"",i.alt=void 0!=a.attr("alt")?a.attr("alt"):"",i.theclass=void 0!=a.attr("class")?a.attr("class"):"",i.styles=void 0!=a.attr("style")?a.attr("style"):"",i.orig=a.clone(),i.datahref=void 0!=a.attr("data-href")?a.attr("data-href"):"",i.content="",e(this).find("img").length>0&&(e.BrowserTests.cssBackgroundSize&&e(this).find("img").first().remove(),i.content=e(this).html()),a[0].src="",e.BrowserTests.cssBackgroundSize&&e(this).remove(),n.push(i)}),d.debug&&(a(" - Slide Object - "),a(n)),n},msie:function(){for(var e=3,i=document.createElement("div"),t=i.getElementsByTagName("i");i.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",t[0];);return e>4?e:void 0},sizes:function(){var i={h:0,w:0};if("window"==d.fillElement)i.h=e.Window.height(),i.w=e.Window.width();else{var a=t.parents(d.fillElement).first();0==a.height()||1==a.data("windowHeight")?(a.data("windowHeight",!0),i.h=e.Window.height()):i.h=a.height(),0==a.width()||1==a.data("windowWidth")?(a.data("windowWidth",!0),i.w=e.Window.width()):i.w=a.width()}return i}};if(e.BrowserTests=h.browser_tests(),"string"==typeof i){if(e.BrowserTests.html5Video||!t.is("video")){var w,m=t.is("object")?t.parent().first():t;e.Body.hasClass("mc-old-browser")||e.Body.addClass("mc-old-browser"),e.Window.data("h",h.sizes().h).data("w",h.sizes().w),m.data("h",t.height()).data("w",t.width()).data("ar",t.width()/t.height()),e.Window.bind(e.Events.RESIZE,function(){e.Window.data("h",h.sizes().h).data("w",h.sizes().w),w=t.data("resizer"),clearTimeout(w),w=setTimeout(l[i](t),200),t.data("resizer",w)}),l[i](t)}}else e.Slides=h.construct_slide_object(),e.BrowserTests.cssBackgroundSize?(d.debug&&a(" - Using Modern - "),o.setup()):(d.debug&&a(" - Using Old - "),r.setup())})},e.fn.maximage.defaults={debug:!1,cssBackgroundSize:!0,cssTransitions:!0,verticalCenter:!0,horizontalCenter:!0,scaleInterval:20,backgroundSize:"cover",fillElement:"window",overrideMSIEStop:!1,onFirstImageLoaded:function(){},onImagesLoaded:function(){}}}(jQuery);